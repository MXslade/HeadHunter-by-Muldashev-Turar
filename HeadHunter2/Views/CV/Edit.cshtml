@model HeadHunter2.ViewModels.CVFormViewModel
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<link href='@Url.Content("~/Content/themes/base/all.css")' rel="stylesheet" type="text/css" />

<h4 class="mb-4">Edit CV</h4>

@using (Html.BeginForm("SaveEdit", "CV", FormMethod.Post, new { role = "form" }))
{
    @Html.AntiForgeryToken()
    <div class="form-group row">
        @Html.LabelFor(m => m.CV.Title, new { @class = "col-md-2 col-form-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.CV.Title, new { @class = "form-control", value = Model.CV.Title })
        </div>
    </div>
    <div class="form-group row">
        @Html.LabelFor(m => m.CV.CountryId, new { @class = "col-md-2 col-form-label" })
        <div class="col-md-10">
            @Html.DropDownListFor(m => m.CV.CountryId, new SelectList(Model.Countries, "Id", "Name", Model.CV.Country), new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group row">
        @Html.LabelFor(m => m.CV.CityId, new { @class = "col-md-2 col-form-label" })
        <div class="col-md-10">
            @Html.DropDownListFor(m => m.CV.CityId, new SelectList(Model.Cities, "Id", "Name"), new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group row">
        @Html.LabelFor(m => m.CV.Salary, new { @class = "col-md-2 col-form-label" })
        <div class="col-md-10">
            @Html.TextBoxFor(m => m.CV.Salary, new { @class = "form-control" })
        </div>
    </div>
    <div class="form-group row">
        @Html.LabelFor(m => m.CV.About, new { @class = "col-md-2 col-form-label" })
        <div class="col-md-10">
            @Html.TextAreaFor(m => m.CV.About, new { @class = "form-control" })
        </div>
    </div>
    <input type="hidden" name="CV.ApplicationUserId" value="@Model.User.Id" />
    <input type="hidden" name="CV.Id" value="@Model.CV.Id" />
    <div class="form-group row">
        <div class="col-md-offset-2 col-md-10">
            <input type="submit" class="btn btn-primary" value="Save" />
            @Html.ActionLink("Delete", "Delete", "CV", new { Id = Model.CV.Id }, new { @class = "btn btn-danger" })
        </div>
    </div>
}

<h4 class="mb-4">Manage Professional Fields</h4>
<table class="table">
    <thead>
        <tr>
            <th scope="col">Name</th>
            <th scope="col" style="width: 5%">Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var professionalField in Model.CV.ProfessionalFields)
        {
            <tr>
                <th scope="row">@professionalField.Name</th>
                <td>
                    @using (Html.BeginForm("RemoveFromCv", "CV", FormMethod.Post))
                    {
                        <input type="hidden" value="@Model.CV.Id" name="cv_id" />
                        <input type="hidden" value="@professionalField.Id" name="professional_field_id" />
                        <input type="submit" class="btn btn-danger w-100" value="-" />
                    }
                </td>
            </tr>
        }
        @foreach (var professionalField in Model.ProfessionalFields)
        {
            <tr>
                <th scope="row">@professionalField.Name</th>
                <td>
                    @using (Html.BeginForm("AddToCv", "CV", FormMethod.Post))
                    {
                        <input type="hidden" value="@Model.CV.Id" name="cv_id" />
                        <input type="hidden" value="@professionalField.Id" name="professional_field_id" />
                        <input type="submit" class="btn btn-success w-100" value="+" />
                    }
                </td>
            </tr>
        }
    </tbody>
</table>

<h4 class="mb-4">Manage Education</h4>

<div id="accordion1" class="mb-4">
    @foreach (var education in Model.CV.Educations)
    {
        <h3>@education.Place</h3>
        <div class="jumbotron">
            <h1 class="display-4">@education.Place</h1>
            <h3>Faculty: @education.Faculty</h3>
            <h4>Speciality: @education.Speciality</h4>
            <p class="lead">@education.Level</p>
            <hr class="my-4">
            <p>Year of completion: @education.YearOfCompletion</p>
            @Html.ActionLink("Edit", "Edit", "Education", new { educationId = @education.Id }, new { @class = "btn btn-warning" })
            @Html.ActionLink("Delete", "Delete", "Education", new { educationId = @education.Id }, new { @class = "btn btn-danger" })
        </div>
    }
</div>

@Html.ActionLink("Add Education", "Create", "Education", new { cvId = Model.CV.Id }, new { @class = "btn btn-success" })

<h4 class="my-4">Manage Job Experience</h4>

<div id="accordion2" class="mb-4">
    @foreach (var jobExperience in Model.CV.JobExperiences)
    {
        <h3>@jobExperience.CompanyName</h3>
        <div class="jumbotron">
            <h1 class="display-4">@jobExperience.CompanyName</h1>
            <h3>Faculty: @jobExperience.Position</h3>
            <p class="lead">@jobExperience.BeginDate - @jobExperience.EndDate</p>
            <hr class="my-4">
            <p>Duration: @jobExperience.CountDuration()</p>
            @Html.ActionLink("Edit", "Edit", "JobExperience", new { jobExperienceId = @jobExperience.Id }, new { @class = "btn btn-warning" })
            @Html.ActionLink("Delete", "Delete", "JobExperience", new { jobExperienceId = @jobExperience.Id }, new { @class = "btn btn-danger" })
        </div>
    }
</div>



@Html.ActionLink("Add Job Experience", "Create", "JobExperience", new { cvId = Model.CV.Id }, new { @class = "btn btn-success" })

<script src='@Url.Content("~/Scripts/jquery-3.5.1.min.js")' type="text/javascript"></script>
<script src='@Url.Content("~/Scripts/jquery-ui-1.12.1.min.js")' type="text/javascript"></script>

<script>
    $("#accordion1").accordion();
    $("#accordion2").accordion();
</script>